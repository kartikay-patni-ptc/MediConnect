<p-dialog [(visible)]="visible" [modal]="true" [closable]="true" [dismissableMask]="true" [style]="{width: '400px'}" (onHide)="close()" header="Book Appointment">
  <form [formGroup]="bookingForm" (ngSubmit)="submit()" class="space-y-4">
    <div *ngIf="doctor" class="mb-2">
      <div class="font-semibold">Doctor:</div>
      <div>Dr. {{ doctor.firstName }} {{ doctor.lastName }} ({{ doctor.specialization }})</div>
    </div>
    <div class="mb-2">
      <label for="slotId" class="block font-medium mb-1">Select Slot</label>
      <p-dropdown id="slotId" formControlName="slotId" [options]="slots" optionLabel="startTime" optionValue="id" [filter]="true" placeholder="Choose a slot" [disabled]="isLoading || !slots.length"></p-dropdown>
      <div *ngIf="!slots.length && !isLoading" class="text-xs text-red-500 mt-1">No available slots for this doctor.</div>
    </div>
    <div class="mb-2">
      <label for="notes" class="block font-medium mb-1">Notes (optional)</label>
      <textarea id="notes" pInputTextarea formControlName="notes" rows="2" class="w-full"></textarea>
    </div>
    <div *ngIf="aiSummary" class="mb-2 bg-blue-50 p-2 rounded text-xs">
      <div class="font-semibold mb-1">AI Summary:</div>
      <div>{{ aiSummary }}</div>
    </div>
    <div *ngIf="error" class="text-red-500 text-xs mb-2">{{ error }}</div>
    <div class="flex justify-end gap-2 mt-4">
      <button pButton type="button" label="Cancel" class="p-button-text" (click)="close()"></button>
      <button pButton type="submit" label="Book" [disabled]="isLoading || !bookingForm.valid || !slots.length" [loading]="isLoading" class="p-button-primary"></button>
    </div>
  </form>
</p-dialog>

